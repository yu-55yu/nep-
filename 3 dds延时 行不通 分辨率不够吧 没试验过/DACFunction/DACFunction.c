#include "DACFunction.h"

const uint16_t Sine12bit[100]={
	2048, 2113, 2177, 2240, 2301, 2361, 2419, 2476, 2531, 2584,
	2635, 2683, 2729, 2772, 2812, 2850, 2884, 2915, 2943, 2967,
	2988, 3005, 3018, 3027, 3032, 3033, 3027, 3018, 3005, 2988,
	2967, 2943, 2915, 2884, 2850, 2812, 2772, 2729, 2683, 2635,
	2584, 2531, 2476, 2419, 2361, 2301, 2240, 2177, 2113, 2048,
	1983, 1919, 1856, 1795, 1735, 1677, 1620, 1565, 1512, 1461,
	1413, 1367, 1324, 1284, 1246, 1210, 1179, 1151, 1127, 1106,
	1089, 1073, 1062, 1053, 1048, 1047, 1053, 1062, 1073, 1089,
	1106, 1127, 1151, 1179, 1210, 1246, 1284, 1324, 1367, 1413,
	1461, 1512, 1565, 1620, 1677, 1735, 1795, 1856, 1919, 1983
};

const uint16_t TriangleWave[100] = {
    2050, 2091, 2132, 2173, 2214, 2255, 2296, 2337, 2378, 2419,
    2460, 2501, 2542, 2583, 2624, 2665, 2706, 2747, 2788, 2829,
    2870, 2911, 2952, 2993, 3034, 3075, 3116, 3157, 3198, 3239,
    3280, 3321, 3362, 3403, 3444, 3485, 3526, 3567, 3608, 3649,
    3690, 3731, 3772, 3813, 3854, 3895, 3936, 3977, 4018, 4059,
	4038, 4018, 3977, 3936, 3895, 3854, 3813, 3772, 3731, 3690,
	3649, 3608, 3567, 3526, 3485, 3444, 3403, 3362, 3321, 3280,
	3239, 3198, 3157, 3116, 3075, 3034, 2993, 2952, 2911, 2870,
	2829, 2788, 2747, 2706, 2665, 2624, 2583, 2542, 2501, 2460,
	2419, 2378, 2337, 2296, 2255, 2214, 2173, 2132, 2091, 2050
};

uint16_t SquareWave[100] = {
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
	4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
	4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
	4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
	4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095,
	4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095, 4095
};



//设置DAC输出波频率
void Frequency_Set(float Frequency,uint32_t Channel)//修改频率
{
	uint32_t ARR=2400000/100/Frequency-1;
	if(Channel == DAC_CHANNEL_1)
    {
		HAL_TIM_Base_Stop(&htim4);
		__HAL_TIM_SetAutoreload(&htim4, ARR);//设置1频率
		HAL_TIM_Base_Start(&htim4);
	}
   
	if(Channel == DAC_CHANNEL_2)
	{
	HAL_TIM_Base_Stop(&htim5);
	__HAL_TIM_SetAutoreload(&htim5, ARR);//设置2频率
	HAL_TIM_Base_Start(&htim5);
	}
}


//amp是幅值，范围0-3V
void Amp_Set(float Amp,uint32_t Channel,uint16_t *WaveData)//修改幅值
{
	float AmpWord = Amp/3000;
	for (int i = 0; i < 100; i++)
	{
		float temp = WaveData[i] * AmpWord;
		WaveData[i] = (uint16_t)temp;
	}
}



