#include "DDS.h"

uint16_t SINEWAVE[WAVE_POINT] = {
    2048,2052,2056,2060,2065,2069,2073,2078,2082,2086,2090,2095,2099,2103,2108,2112,
2116,2120,2125,2129,2133,2137,2142,2146,2150,2154,2159,2163,2167,2171,2175,2180,
2184,2188,2192,2196,2201,2205,2209,2213,2217,2222,2226,2230,2234,2238,2242,2246,
2250,2254,2259,2263,2267,2271,2275,2279,2283,2287,2291,2295,2299,2303,2307,2311,
2315,2319,2323,2327,2331,2334,2338,2342,2346,2350,2354,2358,2361,2365,2369,2373,
2377,2380,2384,2388,2391,2395,2399,2403,2406,2410,2413,2417,2421,2424,2428,2431,
2435,2438,2442,2445,2449,2452,2456,2459,2463,2466,2469,2473,2476,2480,2483,2486,
2489,2493,2496,2499,2502,2506,2509,2512,2515,2518,2521,2524,2527,2530,2533,2536,
2539,2542,2545,2548,2551,2554,2557,2560,2563,2565,2568,2571,2574,2576,2579,2582,
2585,2587,2590,2592,2595,2598,2600,2603,2605,2608,2610,2612,2615,2617,2620,2622,
2624,2626,2629,2631,2633,2635,2638,2640,2642,2644,2646,2648,2650,2652,2654,2656,
2658,2660,2662,2664,2665,2667,2669,2671,2673,2674,2676,2678,2679,2681,2683,2684,
2686,2687,2689,2690,2692,2693,2694,2696,2697,2698,2700,2701,2702,2703,2705,2706,
2707,2708,2709,2710,2711,2712,2713,2714,2715,2716,2717,2718,2718,2719,2720,2721,
2721,2722,2723,2723,2724,2725,2725,2726,2726,2727,2727,2727,2728,2728,2729,2729,
2729,2729,2730,2730,2730,2730,2730,2730,2730,2730,2731,2730,2730,2730,2730,2730,
2730,2730,2730,2729,2729,2729,2729,2728,2728,2727,2727,2727,2726,2726,2725,2725,
2724,2723,2723,2722,2721,2721,2720,2719,2718,2718,2717,2716,2715,2714,2713,2712,
2711,2710,2709,2708,2707,2706,2705,2703,2702,2701,2700,2698,2697,2696,2694,2693,
2692,2690,2689,2687,2686,2684,2683,2681,2679,2678,2676,2674,2673,2671,2669,2667,
2665,2664,2662,2660,2658,2656,2654,2652,2650,2648,2646,2644,2642,2640,2638,2635,
2633,2631,2629,2626,2624,2622,2620,2617,2615,2612,2610,2608,2605,2603,2600,2598,
2595,2592,2590,2587,2585,2582,2579,2576,2574,2571,2568,2565,2563,2560,2557,2554,
2551,2548,2545,2542,2539,2536,2533,2530,2527,2524,2521,2518,2515,2512,2509,2506,
2502,2499,2496,2493,2489,2486,2483,2480,2476,2473,2469,2466,2463,2459,2456,2452,
2449,2445,2442,2438,2435,2431,2428,2424,2421,2417,2413,2410,2406,2403,2399,2395,
2391,2388,2384,2380,2377,2373,2369,2365,2361,2358,2354,2350,2346,2342,2338,2334,
2331,2327,2323,2319,2315,2311,2307,2303,2299,2295,2291,2287,2283,2279,2275,2271,
2267,2263,2259,2254,2250,2246,2242,2238,2234,2230,2226,2222,2217,2213,2209,2205,
2201,2196,2192,2188,2184,2180,2175,2171,2167,2163,2159,2154,2150,2146,2142,2137,
2133,2129,2125,2120,2116,2112,2108,2103,2099,2095,2090,2086,2082,2078,2073,2069,
2065,2060,2056,2052,2048,2043,2039,2035,2030,2026,2022,2017,2013,2009,2005,2000,
1996,1992,1987,1983,1979,1975,1970,1966,1962,1958,1953,1949,1945,1941,1936,1932,
1928,1924,1920,1915,1911,1907,1903,1899,1894,1890,1886,1882,1878,1873,1869,1865,
1861,1857,1853,1849,1845,1841,1836,1832,1828,1824,1820,1816,1812,1808,1804,1800,
1796,1792,1788,1784,1780,1776,1772,1768,1764,1761,1757,1753,1749,1745,1741,1737,
1734,1730,1726,1722,1718,1715,1711,1707,1704,1700,1696,1692,1689,1685,1682,1678,
1674,1671,1667,1664,1660,1657,1653,1650,1646,1643,1639,1636,1632,1629,1626,1622,
1619,1615,1612,1609,1606,1602,1599,1596,1593,1589,1586,1583,1580,1577,1574,1571,
1568,1565,1562,1559,1556,1553,1550,1547,1544,1541,1538,1535,1532,1530,1527,1524,
1521,1519,1516,1513,1510,1508,1505,1503,1500,1497,1495,1492,1490,1487,1485,1483,
1480,1478,1475,1473,1471,1469,1466,1464,1462,1460,1457,1455,1453,1451,1449,1447,
1445,1443,1441,1439,1437,1435,1433,1431,1430,1428,1426,1424,1422,1421,1419,1417,
1416,1414,1412,1411,1409,1408,1406,1405,1403,1402,1401,1399,1398,1397,1395,1394,
1393,1392,1390,1389,1388,1387,1386,1385,1384,1383,1382,1381,1380,1379,1378,1377,
1377,1376,1375,1374,1374,1373,1372,1372,1371,1370,1370,1369,1369,1368,1368,1368,
1367,1367,1366,1366,1366,1366,1365,1365,1365,1365,1365,1365,1365,1365,1365,1365,
1365,1365,1365,1365,1365,1365,1365,1366,1366,1366,1366,1367,1367,1368,1368,1368,
1369,1369,1370,1370,1371,1372,1372,1373,1374,1374,1375,1376,1377,1377,1378,1379,
1380,1381,1382,1383,1384,1385,1386,1387,1388,1389,1390,1392,1393,1394,1395,1397,
1398,1399,1401,1402,1403,1405,1406,1408,1409,1411,1412,1414,1416,1417,1419,1421,
1422,1424,1426,1428,1430,1431,1433,1435,1437,1439,1441,1443,1445,1447,1449,1451,
1453,1455,1457,1460,1462,1464,1466,1469,1471,1473,1475,1478,1480,1483,1485,1487,
1490,1492,1495,1497,1500,1503,1505,1508,1510,1513,1516,1519,1521,1524,1527,1530,
1532,1535,1538,1541,1544,1547,1550,1553,1556,1559,1562,1565,1568,1571,1574,1577,
1580,1583,1586,1589,1593,1596,1599,1602,1606,1609,1612,1615,1619,1622,1626,1629,
1632,1636,1639,1643,1646,1650,1653,1657,1660,1664,1667,1671,1674,1678,1682,1685,
1689,1692,1696,1700,1704,1707,1711,1715,1718,1722,1726,1730,1734,1737,1741,1745,
1749,1753,1757,1761,1764,1768,1772,1776,1780,1784,1788,1792,1796,1800,1804,1808,
1812,1816,1820,1824,1828,1832,1836,1841,1845,1849,1853,1857,1861,1865,1869,1873,
1878,1882,1886,1890,1894,1899,1903,1907,1911,1915,1920,1924,1928,1932,1936,1941,
1945,1949,1953,1958,1962,1966,1970,1975,1979,1983,1987,1992,1996,2000,2005,2009,
2013,2017,2022,2026,2030,2035,2039,2043
};
uint16_t TRIANGLEWAVE[WAVE_POINT] = {
   2048,2052,2056,2060,2065,2069,2073,2078,2082,2086,2090,2095,2099,2103,2108,2112,
2116,2120,2125,2129,2133,2137,2142,2146,2150,2154,2159,2163,2167,2171,2175,2180,
2184,2188,2192,2196,2201,2205,2209,2213,2217,2222,2226,2230,2234,2238,2242,2246,
2250,2254,2259,2263,2267,2271,2275,2279,2283,2287,2291,2295,2299,2303,2307,2311,
2315,2319,2323,2327,2331,2334,2338,2342,2346,2350,2354,2358,2361,2365,2369,2373,
2377,2380,2384,2388,2391,2395,2399,2403,2406,2410,2413,2417,2421,2424,2428,2431,
2435,2438,2442,2445,2449,2452,2456,2459,2463,2466,2469,2473,2476,2480,2483,2486,
2489,2493,2496,2499,2502,2506,2509,2512,2515,2518,2521,2524,2527,2530,2533,2536,
2539,2542,2545,2548,2551,2554,2557,2560,2563,2565,2568,2571,2574,2576,2579,2582,
2585,2587,2590,2592,2595,2598,2600,2603,2605,2608,2610,2612,2615,2617,2620,2622,
2624,2626,2629,2631,2633,2635,2638,2640,2642,2644,2646,2648,2650,2652,2654,2656,
2658,2660,2662,2664,2665,2667,2669,2671,2673,2674,2676,2678,2679,2681,2683,2684,
2686,2687,2689,2690,2692,2693,2694,2696,2697,2698,2700,2701,2702,2703,2705,2706,
2707,2708,2709,2710,2711,2712,2713,2714,2715,2716,2717,2718,2718,2719,2720,2721,
2721,2722,2723,2723,2724,2725,2725,2726,2726,2727,2727,2727,2728,2728,2729,2729,
2729,2729,2730,2730,2730,2730,2730,2730,2730,2730,2731,2730,2730,2730,2730,2730,
2730,2730,2730,2729,2729,2729,2729,2728,2728,2727,2727,2727,2726,2726,2725,2725,
2724,2723,2723,2722,2721,2721,2720,2719,2718,2718,2717,2716,2715,2714,2713,2712,
2711,2710,2709,2708,2707,2706,2705,2703,2702,2701,2700,2698,2697,2696,2694,2693,
2692,2690,2689,2687,2686,2684,2683,2681,2679,2678,2676,2674,2673,2671,2669,2667,
2665,2664,2662,2660,2658,2656,2654,2652,2650,2648,2646,2644,2642,2640,2638,2635,
2633,2631,2629,2626,2624,2622,2620,2617,2615,2612,2610,2608,2605,2603,2600,2598,
2595,2592,2590,2587,2585,2582,2579,2576,2574,2571,2568,2565,2563,2560,2557,2554,
2551,2548,2545,2542,2539,2536,2533,2530,2527,2524,2521,2518,2515,2512,2509,2506,
2502,2499,2496,2493,2489,2486,2483,2480,2476,2473,2469,2466,2463,2459,2456,2452,
2449,2445,2442,2438,2435,2431,2428,2424,2421,2417,2413,2410,2406,2403,2399,2395,
2391,2388,2384,2380,2377,2373,2369,2365,2361,2358,2354,2350,2346,2342,2338,2334,
2331,2327,2323,2319,2315,2311,2307,2303,2299,2295,2291,2287,2283,2279,2275,2271,
2267,2263,2259,2254,2250,2246,2242,2238,2234,2230,2226,2222,2217,2213,2209,2205,
2201,2196,2192,2188,2184,2180,2175,2171,2167,2163,2159,2154,2150,2146,2142,2137,
2133,2129,2125,2120,2116,2112,2108,2103,2099,2095,2090,2086,2082,2078,2073,2069,
2065,2060,2056,2052,2048,2043,2039,2035,2030,2026,2022,2017,2013,2009,2005,2000,
1996,1992,1987,1983,1979,1975,1970,1966,1962,1958,1953,1949,1945,1941,1936,1932,
1928,1924,1920,1915,1911,1907,1903,1899,1894,1890,1886,1882,1878,1873,1869,1865,
1861,1857,1853,1849,1845,1841,1836,1832,1828,1824,1820,1816,1812,1808,1804,1800,
1796,1792,1788,1784,1780,1776,1772,1768,1764,1761,1757,1753,1749,1745,1741,1737,
1734,1730,1726,1722,1718,1715,1711,1707,1704,1700,1696,1692,1689,1685,1682,1678,
1674,1671,1667,1664,1660,1657,1653,1650,1646,1643,1639,1636,1632,1629,1626,1622,
1619,1615,1612,1609,1606,1602,1599,1596,1593,1589,1586,1583,1580,1577,1574,1571,
1568,1565,1562,1559,1556,1553,1550,1547,1544,1541,1538,1535,1532,1530,1527,1524,
1521,1519,1516,1513,1510,1508,1505,1503,1500,1497,1495,1492,1490,1487,1485,1483,
1480,1478,1475,1473,1471,1469,1466,1464,1462,1460,1457,1455,1453,1451,1449,1447,
1445,1443,1441,1439,1437,1435,1433,1431,1430,1428,1426,1424,1422,1421,1419,1417,
1416,1414,1412,1411,1409,1408,1406,1405,1403,1402,1401,1399,1398,1397,1395,1394,
1393,1392,1390,1389,1388,1387,1386,1385,1384,1383,1382,1381,1380,1379,1378,1377,
1377,1376,1375,1374,1374,1373,1372,1372,1371,1370,1370,1369,1369,1368,1368,1368,
1367,1367,1366,1366,1366,1366,1365,1365,1365,1365,1365,1365,1365,1365,1365,1365,
1365,1365,1365,1365,1365,1365,1365,1366,1366,1366,1366,1367,1367,1368,1368,1368,
1369,1369,1370,1370,1371,1372,1372,1373,1374,1374,1375,1376,1377,1377,1378,1379,
1380,1381,1382,1383,1384,1385,1386,1387,1388,1389,1390,1392,1393,1394,1395,1397,
1398,1399,1401,1402,1403,1405,1406,1408,1409,1411,1412,1414,1416,1417,1419,1421,
1422,1424,1426,1428,1430,1431,1433,1435,1437,1439,1441,1443,1445,1447,1449,1451,
1453,1455,1457,1460,1462,1464,1466,1469,1471,1473,1475,1478,1480,1483,1485,1487,
1490,1492,1495,1497,1500,1503,1505,1508,1510,1513,1516,1519,1521,1524,1527,1530,
1532,1535,1538,1541,1544,1547,1550,1553,1556,1559,1562,1565,1568,1571,1574,1577,
1580,1583,1586,1589,1593,1596,1599,1602,1606,1609,1612,1615,1619,1622,1626,1629,
1632,1636,1639,1643,1646,1650,1653,1657,1660,1664,1667,1671,1674,1678,1682,1685,
1689,1692,1696,1700,1704,1707,1711,1715,1718,1722,1726,1730,1734,1737,1741,1745,
1749,1753,1757,1761,1764,1768,1772,1776,1780,1784,1788,1792,1796,1800,1804,1808,
1812,1816,1820,1824,1828,1832,1836,1841,1845,1849,1853,1857,1861,1865,1869,1873,
1878,1882,1886,1890,1894,1899,1903,1907,1911,1915,1920,1924,1928,1932,1936,1941,
1945,1949,1953,1958,1962,1966,1970,1975,1979,1983,1987,1992,1996,2000,2005,2009,
2013,2017,2022,2026,2030,2035,2039,2043
};

uint64_t place[2]={0};
uint32_t ctrl_word1;
uint32_t ctrl_word2;
uint32_t phase_word[2]={0};
uint8_t phaseFlag[2]={1};
uint16_t pData1[WAVE_POINT]={0};
uint16_t pData2[WAVE_POINT]={0};
extern uint16_t DAC_Buffer1[WAVE_POINT];
extern uint16_t DAC_Buffer2[WAVE_POINT];
Signal Wave[2];


extern SignalType gwave_type[2];


void phaseChange(float phaseValue,int Channal)//相位改变代码
{
    phase_word[Channal]=(uint32_t)(phaseValue/(PI*2)*4294967295.0);
    place[Channal]+=phase_word[Channal];
}


void DDS_SetWaveform(Signal Waves, int Channel) {
    uint16_t *waveform = NULL;
    waveform = Waves.Type == TRIANGLE ? TRIANGLEWAVE : SINEWAVE;
    if (Channel == 0) {
        for (int i = 0; i < WAVE_POINT; i++) {
            DAC_Buffer1[i] = waveform[i];
        }
    } else if (Channel == 1) {
        for (int i = 0; i < WAVE_POINT; i++) {
            DAC_Buffer2[i] = waveform[i];
        }
    }
}
// 设置波形参数
void DDS_SetParameter(Signal wave[]) {
	ctrl_word1=1;
    ctrl_word2=1;
	for(int i=0; i<2; i++)
	{
		DDS_SetWaveform(Wave[i],i);
	}
}

